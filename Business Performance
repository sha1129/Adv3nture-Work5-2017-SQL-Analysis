Number of shipments made per

SELECT COUNT (s.ShipDateKey) 'Number_Of_Shipment', DATEPART(m,s.ShipDate) as 'MonthNumb'
FROM FactInternetSales s
WHERE YEAR(s.ShipDate) = 2013
GROUP BY DATEPART(m, s.ShipDate)
ORDER BY DATEPART(m, s.ShipDate)


-- Which Territory Made the most sales
SELECT count(s.SalesTerritoryKey) 'NumberOfSale', st.SalesTerritoryRegion, st.SalesTerritoryCountry
FROM FactInternetSales s 
JOIN DimSalesTerritory st ON s.SalesTerritoryKey = st.SalesTerritoryKey
WHERE YEAR(s.ShipDate) = 2013
GROUP BY s.SalesTerritoryKey, st.SalesTerritoryRegion, st.SalesTerritoryCountry
ORDER BY count(s.SalesTerritoryKey) DESC

-- Now lets look at top 20 products that got sold in 2013 from our distirbutation center
SELECT top(20) p.EnglishProductName, count(s.ProductKey) NumberOfItemsSold
FROM FactInternetSales s
JOIN DimProduct p ON s.ProductKey = p.ProductKey
WHERE YEAR(s.ShipDate) = 2013
GROUP BY s.ProductKey, p.EnglishProductName
ORDER BY count(s.ProductKey) desc 

-- From last query we know that Water Bottle - 30 oz. got sold the most
-- now need to know the location that got sold the most

SELECT p.EnglishProductName, count(s.ProductKey) NumberOfItemsSold, st.SalesTerritoryCountry
FROM FactInternetSales s
JOIN DimProduct p ON s.ProductKey = p.ProductKey
JOIN DimSalesTerritory st ON s.SalesTerritoryKey = st.SalesTerritoryKey
WHERE p.EnglishProductName like 'Water Bottle - 30 oz.'
GROUP BY st.SalesTerritoryCountry,s.ProductKey, p.EnglishProductName
ORDER BY count(s.ProductKey) desc 

-- US sold the most 
