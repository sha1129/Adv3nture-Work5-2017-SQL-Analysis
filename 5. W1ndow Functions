-- Window Function 
A window function calculate rows that have pk/fk relations to the current row. (source Mode)

Examples: Calculate grand total starting from the year 2010

SELECT DISTINCT YEAR(OrderDate) ,
                SUM(SalesAmount) OVER(order by YEAR(OrderDate))
FROM FactInternetSales
ORDER BY YEAR(OrderDate);

-- Window function is useful to find ranking 
-- This query will find ranking of customers which will display full names

SELECT DISTINCT TOP 10 s.CustomerKey, 
                CONCAT(c.FirstName,' ',c.LastName) AS FullName,
                SUM(s.SalesAmount) AS DollarSpent, 
                RANK() OVER (ORDER BY SUM(s.SalesAmount) DESC) AS Ranking
FROM FactInternetSales s
JOIN DimCustomer c 
    ON s.CustomerKey = c.CustomerKey
WHERE YEAR(s.OrderDate) = 2013
group by s.CustomerKey, CONCAT(c.FirstName,' ',c.LastName)



