-- Query Look at Weekly Sales
-- Notes DATEPART function returns integer representation of the format given in brackets
**THis is boidl**
 
SELECT SUM(ft.SalesAmount) AS 'WeeklySales', DATEPART(ww,ft.OrderDate) AS 'WeekNum'
FROM FactInternetSales ft 
WHERE YEAR (ft.OrderDate) = 2013
GROUP BY DATEPART(ww,ft.OrderDate)
ORDER BY DATEPART(ww,ft.OrderDate) ASC

-- Number of Employees in 2013 

SELECT COUNT (1)
FROM DimEmployee emp
WHERE emp.StartDate <= '2013-01-01'
    AND (
        emp.EndDate > '2013-01-01'
        OR emp.EndDate IS NULL 
    );
    
-- 290 answers

-- Using partition Windows Funcitons to find average sales by Territoy and Region

SELECT DISTINCT 
       t.SalesTerritoryGroup,
       t.SalesTerritoryRegion,
       AVG(ft.SalesAmount) OVER(PARTITION BY t.SalesTerritoryRegion) AS 'GroupAvgSales'
FROM FactInternetSales ft
JOIN DimSalesTerritory t ON
   ft.SalesTerritoryKey = t.SalesTerritoryKey
WHERE 
   YEAR(ft.OrderDate) = 2013
ORDER BY  
   GroupAvgSales desc;
   
 ---Answer---  
Pacific	Australia	392.5677
Europe	Germany	356.8718
Europe	United Kingdom	346.2114
Europe	France	323.4655
North America	Southwest	308.2826
North America	Northwest	262.5548



